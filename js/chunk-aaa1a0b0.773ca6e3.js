(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-aaa1a0b0"],{2009:function(t,e,n){},2192:function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.val?n("div",[n("Modal",{attrs:{title:"订单付款","mask-closable":!1},on:{"on-cancel":t.cancel},model:{value:t.showInfo,callback:function(e){t.showInfo=e},expression:"showInfo"}},[n("Row",{staticClass:"item",attrs:{type:"flex"}},[n("Row",{staticClass:"item-label",attrs:{type:"flex",justify:"end"}},[n("b",[t._v("订单号:")])]),n("div",[t._v(t._s(t.number))])],1),n("Row",{staticClass:"item",attrs:{type:"flex"}},[n("Row",{staticClass:"item-label",attrs:{type:"flex",justify:"end"}},[n("b",[t._v("联系人:")])]),n("div",[t._v(t._s(t.shippingName))])],1),n("Row",{staticClass:"item",attrs:{type:"flex"}},[n("Row",{staticClass:"item-label",attrs:{type:"flex",justify:"end"}},[n("b",[t._v("手机号:")])]),n("div",[t._v(t._s(t.shippingPhone))])],1),n("Row",{staticClass:"item",attrs:{type:"flex"}},[n("Row",{staticClass:"item-label",attrs:{type:"flex",justify:"end"}},[n("b",[t._v("商品信息:")])]),n("div",[t._v(t._s(t.productInfo))])],1),n("Row",{staticClass:"item",attrs:{type:"flex"}},[n("Row",{staticClass:"item-label",attrs:{type:"flex",justify:"end"}},[n("b",[t._v("数量:")])]),n("div",[t._v(t._s(t.quantity))])],1),n("Row",{staticClass:"item",attrs:{type:"flex",align:"middle"}},[n("Row",{staticClass:"item-label",attrs:{type:"flex",justify:"end"}},[n("b",[t._v("合计:")])]),n("div",{staticClass:"price"},[t._v(t._s(t.ForceMoney(t.amount)))])],1),n("Divider",[t._v("支付方式")]),n("RadioGroup",{staticStyle:{display:"flex","justify-content":"space-between"},model:{value:t.paymentType,callback:function(e){t.paymentType=e},expression:"paymentType"}},[n("Radio",{staticClass:"payment-type",attrs:{label:0,disabled:t.balance<t.amount}},[n("Icons",{attrs:{type:"yuezhifu",size:30,color:"#ffc849"}}),n("v-countup",{attrs:{"end-val":t.balance,decimals:2,"count-style":{color:"#ffc849",fontSize:"18px"}}},[n("span",{staticStyle:{"font-size":"14px","font-weight":"normal"},attrs:{slot:"leftText"},slot:"leftText"},[t._v("可用")]),n("span",{staticStyle:{"font-size":"14px","font-weight":"normal"},attrs:{slot:"rightText"},slot:"rightText"},[t._v("余额")])])],1),n("Radio",{staticClass:"payment-type",attrs:{label:1,disabled:!t.isEnable(1)}},[n("Icons",{attrs:{type:"weipay",size:35,color:t.isEnable(1)?"#12cc0d":"gray"}})],1),n("Radio",{staticClass:"payment-type",attrs:{label:2,disabled:!t.isEnable(2)}},[n("Icons",{attrs:{type:"ali_pay",size:30,color:t.isEnable(2)?"#24abed":"gray"}})],1)],1),n("div",{attrs:{slot:"footer"},slot:"footer"},[n("Button",{attrs:{type:"text",size:"large"},on:{click:function(e){t.val=!1}}},[t._v("取消")]),n("Button",{attrs:{type:"primary",size:"large",loading:t.buttonLoading,disabled:!t.canPay},nativeOn:{click:function(e){return t.pay(e)}}},[t._v("去付款")])],1)],1),n("Modal",{attrs:{width:800,title:"微信扫码支付","footer-hide":"","mask-closable":!1},on:{"on-cancel":t.cancelWx},model:{value:t.showWx,callback:function(e){t.showWx=e},expression:"showWx"}},[n("div",{staticStyle:{display:"flex","justify-content":"center","align-items":"center"}},[n("div",{staticStyle:{display:"flex","align-items":"center","flex-direction":"column"}},[n("div",[n("span",{staticStyle:{"font-size":"28px","margin-right":"10px"}},[t._v("微信支付")]),n("b",{staticClass:"price"},[t._v("￥"+t._s(t.ForceMoney(t.amount)))])]),n("canvas",{attrs:{id:"qr"}}),n("div",{staticStyle:{display:"flex","align-items":"center",width:"176px"}},[n("Icons",{attrs:{type:"scan",size:50}}),n("span",{staticStyle:{"font-size":"16px","margin-left":"10px"}},[t._v("\n                        打开手机微信\n                        扫一扫二维码\n                    ")])],1)]),n("div",{staticClass:"wx-right"},[n("img",{attrs:{src:t.wxScan}})])])])],1):t._e()},i=[],r=n("cebc"),s=(n("96cf"),n("3b8d")),o=(n("c5f6"),n("b375")),u=n.n(o),l=n("2f62"),c=n("086f"),d=n("88ec"),f=n("3796"),p=n("b2d1"),m=n.n(p),h={name:"Pay",components:{Icons:f["a"],VCountup:u.a},props:{order:{type:Object,require:!0},shipping:{type:Object},items:{type:Array},value:{type:Boolean,default:!1}},data:function(){return{wxScan:m.a,ForceMoney:d["c"],val:this.value,account:null,paymentTypes:[],paymentType:0,buttonLoading:!1,showInfo:!0,showWx:!1}},computed:{number:function(){var t;return null===(t=this.order)||void 0===t?void 0:t.number},amount:function(){var t;return(null===(t=this.order)||void 0===t?void 0:t.payAmount)||0},shippingName:function(){var t;return null===(t=this.shipping)||void 0===t?void 0:t.nickname},shippingPhone:function(){var t;return null===(t=this.shipping)||void 0===t?void 0:t.phone},productInfo:function(){var t,e,n,a;return"".concat((null===(t=this.items)||void 0===t?void 0:null===(e=t[0])||void 0===e?void 0:e.productName)||""," - ").concat((null===(n=this.items)||void 0===n?void 0:null===(a=n[0])||void 0===a?void 0:a.productSubName)||"")},quantity:function(){var t;return(null===(t=this.items)||void 0===t?void 0:t.reduce(function(t,e){return t+e.quantity},0))||0},balance:function(){var t,e,n=(null===(t=this.account)||void 0===t?void 0:t.cash)+(null===(e=this.account)||void 0===e?void 0:e.credit);return isNaN(n)?0:Number(Object(d["c"])(n))},canPay:function(){return null!==this.paymentType}},watch:{value:function(){var t=Object(s["a"])(regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(this.val=e,!e){t.next=8;break}return t.next=4,this.getAccountInfo();case 4:return this.account=t.sent,t.next=7,this.getPaymentTypes();case 7:this.showInfo=!0;case 8:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),val:function(t){this.$emit("input",t)}},methods:Object(r["a"])({},Object(l["b"])(["getAccountInfo"]),{getPaymentTypes:function(){var t=Object(s["a"])(regeneratorRuntime.mark(function t(){var e,n,a=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.get("/api/ep-payment-config/list");case 2:e=t.sent,e.success&&(this.paymentTypes=e.value,this.paymentType=this.balance>this.amount?0:(null===(n=[1,2].filter(function(t){return a.isEnable(t)}))||void 0===n?void 0:n[0])||null);case 4:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),isEnable:function(t){return this.paymentTypes.some(function(e){return e.type===t&&e.status})},pay:function(){var t=Object(s["a"])(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.buttonLoading=!0,t.prev=1,t.next=4,this.post("/api/fx/order/payment/".concat(this.order.number,"?type=").concat(this.paymentType));case 4:if(e=t.sent,!e.success){t.next=20;break}if(0!==this.paymentType){t.next=12;break}this.$Notice.success({title:"付款成功"}),this.$emit("paid",this.paymentType),this.val=!1,t.next=20;break;case 12:if(1!==this.paymentType){t.next=19;break}return this.showInfo=!1,t.next=16,c["a"].toCanvas({nodeQrCodeOptions:{margin:0},canvas:document.getElementById("qr"),content:e.value.codeUrl,width:200});case 16:this.showWx=!0,t.next=20;break;case 19:this.$Notice.warning({title:"付款方式错误"});case 20:return t.prev=20,this.buttonLoading=!1,t.finish(20);case 23:case"end":return t.stop()}},t,this,[[1,,20,23]])}));function e(){return t.apply(this,arguments)}return e}(),cancel:function(){this.val=!1,this.showInfo=!1,this.showWx=!1},cancelWx:function(){this.showInfo=!0}})},y=h,v=(n("5b5c"),n("2877")),w=Object(v["a"])(y,a,i,!1,null,"21fbe1ee",null);w.options.__file="pay.vue";e["a"]=w.exports},3452:function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=this,n=e.$createElement,a=e._self._c||n;return a("div",[a("div",{staticClass:"query-row"},[a("div",{staticClass:"query-row-cell"},[a("label",{staticClass:"query-row-cell-label"},[e._v("订单号：")]),a("Input",{staticStyle:{width:"200px"},attrs:{placeholder:"",clearable:""},model:{value:e.table.query.number,callback:function(t){e.$set(e.table.query,"number",t)},expression:"table.query.number"}})],1),a("div",{staticClass:"query-row-cell"},[a("label",{staticClass:"query-row-cell-label"},[e._v("联系电话：")]),a("Input",{staticStyle:{width:"200px"},attrs:{placeholder:"",clearable:""},model:{value:e.table.query.phone,callback:function(t){e.$set(e.table.query,"phone",t)},expression:"table.query.phone"}})],1),1===e.epType&&1===e.userType?a("div",{staticClass:"query-row-cell",staticStyle:{"margin-left":"20px"}},[a("Checkbox",{on:{"on-change":e.doQuery},model:{value:e.table.query.self,callback:function(t){e.$set(e.table.query,"self",t)},expression:"table.query.self"}},[e._v("自己购买")])],1):e._e()]),a("div",{staticClass:"query-row"},[a("div",{staticClass:"query-row-cell"},[a("label",{staticClass:"query-row-cell-label"},[e._v("订单日期：")]),a("DatePicker",{staticStyle:{width:"200px"},attrs:{type:"daterange",options:e.dateRangeOptions,"split-panels":"",placeholder:"选择下单日期区间"},model:{value:e.dateRange,callback:function(t){e.dateRange=t},expression:"dateRange"}})],1),a("div",{staticClass:"query-row-cell"},[a("label",{staticClass:"query-row-cell-label"},[e._v("订单状态：")]),a("RadioGroup",{attrs:{type:"button"},model:{value:e.status,callback:function(t){e.status=t},expression:"status"}},[a("Radio",{attrs:{label:e.statusDic.waitPay}},[e._v("未付款")]),a("Radio",{attrs:{label:e.statusDic.waitAudit}},[e._v("待审核")]),a("Radio",{attrs:{label:e.statusDic.refundTicket}},[e._v("退票中")]),a("Radio",{attrs:{label:e.statusDic.complete}},[e._v("已完成")])],1),a("Dropdown",{staticStyle:{"margin-left":"10px"},on:{"on-click":function(e){return t.status=e}}},[a("a",{attrs:{href:"javascript:void(0)"}},[e._v("\n                    更多\n                    "),a("Icon",{attrs:{type:"ios-arrow-down"}})],1),a("DropdownMenu",{attrs:{slot:"list"},slot:"list"},[a("DropdownItem",{attrs:{name:e.statusDic.nonTicket,selected:e.status===e.statusDic.nonTicket}},[e._v("未出票")]),a("DropdownItem",{attrs:{name:e.statusDic.hasTicket,selected:e.status===e.statusDic.hasTicket}},[e._v("已出票")]),a("DropdownItem",{attrs:{name:e.statusDic.waitRefundTicket,selected:e.status===e.statusDic.waitRefundTicket}},[e._v("退票待审核")]),a("DropdownItem",{attrs:{name:e.statusDic.refundMoney,selected:e.status===e.statusDic.refundMoney}},[e._v("退款中")]),a("DropdownItem",{attrs:{name:e.statusDic.cancel,selected:e.status===e.statusDic.cancel}},[e._v("已取消")]),a("DropdownItem",{attrs:{divided:"",selected:!e.status}},[e._v("全部")])],1)],1)],1),a("Button",{staticClass:"margin-left-10",attrs:{type:"primary",icon:"md-search"},on:{click:e.doQuery}},[e._v("搜索")])],1),a("Row",{staticClass:"margin-top-10"},[a("i-col",[e.haveData?[e._l(e.table.data,function(t){return a("Card",{key:t.id,staticClass:"order-item"},[a("div",{staticClass:"order-item-header",attrs:{slot:"title"},slot:"title"},[a("div",[a("Tag",{staticClass:"margin-right-10",attrs:{color:"blue"}},[e._v(e._s(t.number))]),a("span",[e._v("联系人：")]),a("span",[e._v(e._s(t.shipping.nickname)+"("+e._s(t.shipping.phone)+")")]),a("span",{staticClass:"margin-right-10"},[e._v("【由 "+e._s(t.buyUserId?t.buyUserName:"API")+" 于 "+e._s(e.DateFormat(t.createTime))+" 下单】")])],1),a("div",{staticStyle:{display:"flex","align-items":"center"}},[t.paymentType||0===t.paymentType?a("div",{staticClass:"margin-right-10"},[0===t.paymentType?a("Icons",{attrs:{size:20,color:"#ffc849",type:"yuezhifu"}}):1===t.paymentType?a("Icons",{attrs:{size:20,color:"#12cc0d",type:"wepay"}}):2===t.paymentType?a("Icons",{attrs:{size:20,color:"#24abed",type:"alipay"}}):e._e()],1):e._e(),5===t.status?a("Poptip",{attrs:{trigger:"hover",placement:"left",title:t.buyFailRefundMoney?null:"退款失败",content:t.cancelReason}},[a("Tag",[e._v(e._s(e.opt(e.FxOrderStatus,t.status).name))])],1):1===t.status&&e.isSelfOrder(t)?a("Tag",{attrs:{color:"#f29100"},nativeOn:{click:function(n){e.goToPay(t)}}},[e._v("去支付")]):2===t.status&&e.isSelfOrder(t)?a("Tag",{nativeOn:{click:function(n){e.goToPaying(t)}}},[e._v("付款中")]):a("Tag",[e._v(e._s(e.opt(e.FxOrderStatus,t.status).name))])],1)]),a("Table",{attrs:{columns:e.sub.col,data:t.items}})],1)}),a("div",{staticStyle:{margin:"10px",overflow:"hidden"}},[a("div",{staticStyle:{float:"right"}},[a("Page",{attrs:{total:e.table.total,"show-sizer":!0,placement:"top"},on:{"on-page-size-change":e.changePageSize,"on-change":e.changePage}})],1)])]:a("div",{staticClass:"no-data"},[e._v("订单列表空空如也")])],2)],1),a("Modal",{attrs:{title:"提示","footer-hide":""},model:{value:e.showPaying,callback:function(t){e.showPaying=t},expression:"showPaying"}},[a("Button",{attrs:{type:"success",long:""},on:{click:e.closePaying}},[e._v("继续等待")]),a("br"),a("br"),a("Button",{attrs:{type:"warning",long:""},on:{click:e.rePay}},[e._v("重新支付")]),a("br"),a("br"),a("Alert",{attrs:{"show-icon":""}},[a("template",{slot:"desc"},[a("div",[e._v("如果付款过程中，你已经明确付款成功了，请点击继续等待按钮！")]),a("div",[e._v("如果付款过程中，你已经明确付款失败了，请点击重新支付按钮！")])])],2)],1),a("Pay",{attrs:{order:e.order,shipping:e.order.shipping,items:e.order.items},on:{paid:e.doQuery},model:{value:e.showPay,callback:function(t){e.showPay=t},expression:"showPay"}}),a("Modal",{attrs:{"mask-closable":!1,title:"退订信息",width:"600",loading:e.refund.loading},on:{"on-ok":e.refundApply},model:{value:e.refund.show,callback:function(t){e.$set(e.refund,"show",t)},expression:"refund.show"}},[a("Row",{staticClass:"refund-row",attrs:{gutter:16,type:"flex"}},[a("i-col",{staticClass:"align-right refund-row-label",attrs:{span:"5"}},[e._v("\n                订单商品:\n            ")]),a("i-col",{attrs:{span:"19"}},[e._v("\n                "+e._s(e.refundProduct)+"\n            ")])],1),a("Row",{staticClass:"refund-row",attrs:{gutter:16,type:"flex"}},[a("i-col",{staticClass:"align-right refund-row-label",attrs:{span:"5"}},[e._v("\n                退货规则:\n            ")]),a("i-col",{attrs:{span:"19"}},[e._v("\n                "+e._s(e.refundProduct)+"\n            ")])],1),a("Row",{staticClass:"refund-row",attrs:{gutter:16,type:"flex"}},[a("i-col",{staticClass:"align-right refund-row-label",attrs:{span:"5"}},[e._v("\n                退货详情:\n            ")]),a("i-col",{attrs:{span:"19"}},[a("Table",{attrs:{columns:e.refund.quantity.col,data:e.refund.quantity.data}})],1)],1),a("Row",{staticClass:"refund-row",attrs:{gutter:16,type:"flex"}},[a("i-col",{staticClass:"align-right refund-row-label",attrs:{span:"5"}},[e._v("\n                手续费:\n            ")]),a("i-col",{attrs:{span:"19"}},[e._v("\n                "+e._s(e.ForceMoney(e.refund.fee))+"\n            ")])],1),a("Row",{staticClass:"refund-row",attrs:{gutter:16,type:"flex"}},[a("i-col",{staticClass:"align-right refund-row-label",attrs:{span:"5"}},[e._v("\n                退款金额:\n            ")]),a("i-col",{attrs:{span:"19"}},[e._v("\n                "+e._s(e.ForceMoney(e.refund.money))+"\n            ")])],1),a("Row",{staticClass:"refund-row",attrs:{gutter:16,type:"flex"}},[a("i-col",{staticClass:"align-right refund-row-label",attrs:{span:"5"}},[e._v("\n                退货原因:\n            ")]),a("i-col",{attrs:{span:"19"}},[a("Input",{attrs:{type:"textarea",maxlength:250},model:{value:e.refund.cause,callback:function(t){e.$set(e.refund,"cause",t)},expression:"refund.cause"}})],1)],1),a("Alert",{attrs:{type:"warning","show-icon":""}},[a("template",{slot:"desc"},[a("li",[e._v("提交申请后,如商品需审核则订单会进入“退票待审核”状态,等待供应商确认。")]),a("li",[e._v("余额支付,退票审核通过后会直接退还账户余额;第三方支付则在7个工作日内原路退还。")]),a("li",[e._v("如订单长时间未审核请联系系统客服: 0731-88888888")])])],2)],1),a("Modal",{attrs:{title:"审核订单","footer-hide":""},model:{value:e.audit.show,callback:function(t){e.$set(e.audit,"show",t)},expression:"audit.show"}},[a("Button",{attrs:{type:"success",long:""},on:{click:function(t){e.doAudit(!0)}}},[e._v("接受")]),a("br"),a("br"),a("Button",{attrs:{type:"warning",long:""},on:{click:function(t){e.doAudit(!1)}}},[e._v("拒绝")]),a("br"),a("br"),a("Alert",{attrs:{"show-icon":""}},[a("template",{slot:"desc"},[a("div",[e._v("如果付款过程中，你已经明确付款成功了，请点击继续等待按钮！")]),a("div",[e._v("如果付款过程中，你已经明确付款失败了，请点击重新支付按钮！")])])],2)],1),a("Modal",{attrs:{title:"退订审核","footer-hide":""},model:{value:e.refundAudit.show,callback:function(t){e.$set(e.refundAudit,"show",t)},expression:"refundAudit.show"}},[a("Button",{attrs:{type:"success",long:""},on:{click:function(t){e.doRefundAudit(!0)}}},[e._v("接受")]),a("br"),a("br"),a("Button",{attrs:{type:"warning",long:""},on:{click:function(t){e.doRefundAudit(!1)}}},[e._v("拒绝")]),a("br"),a("br"),a("Alert",{attrs:{"show-icon":""}},[a("template",{slot:"desc"},[a("div",[e._v("如果付款过程中，你已经明确付款成功了，请点击继续等待按钮！")]),a("div",[e._v("如果付款过程中，你已经明确付款失败了，请点击重新支付按钮！")])])],2)],1)],1)},i=[],r=n("a4bb"),s=n.n(r),o=n("cebc"),u=(n("96cf"),n("3b8d")),l=(n("a481"),n("768b")),c=(n("7f7f"),n("5a0c")),d=n.n(c),f=n("88ec"),p=n("f600"),m=n("a7ee"),h=n("9a3e"),y=n("2192"),v=n("3796"),w={name:"OrderList",components:{Icons:v["a"],Pay:y["a"]},mixins:[m["a"],h["a"]],data:function(){var t=this;this.$createElement;return{opt:p["t"],FxOrderStatus:p["g"],DateFormat:f["a"],ForceMoney:f["c"],showPay:!1,showPaying:!1,order:{},sub:{col:[{title:"产品名称",tooltip:!0,render:function(e,n){return t.renderJoin(e,n," - ")("productName","productSubName")}},{title:"生效时间",key:"minEffectiveDate",render:this.renderDate},{title:"过期时间",key:"maxExpiryDate",render:this.renderDate},{title:"单价",key:"settlePrice",render:function(e,n){return t.renderMoney(e,n,function(t){return t/n.row.quantity})}},{title:"数量",width:80,key:"quantity"},{title:"已用",width:80,key:"usedQuantity"},{title:"已退",width:80,key:"refundQuantity"},{title:"过期",width:80,key:"invalidQuantity"},{title:"状态",key:"status",render:function(e,n){return n.row.refundOrder&&7!==n.row.refundOrder.status?e("span",[Object(p["t"])(p["h"],n.row.refundOrder.status).name]):t.renderDic(e,n)(p["f"])}},{title:"操作",key:"action",width:220,align:"center",render:function(e,n){return t.renderActions(e,n,[{config:{loading:t.loadingBtn,style:{marginRight:"5px"},disabled:!t.canRefund(n.row),show:t.canRefund(n.row)},click:function(){return t.refundView(n.row)},text:"申请退订"},{config:{loading:t.loadingBtn,style:{marginRight:"5px"},disabled:!t.canAudit(n.row),show:t.canAudit(n.row)},click:function(){return t.auditView(n.row)},text:"审核"},{config:{loading:t.loadingBtn,style:{marginRight:"5px"},disabled:!t.canTicketing(n.row),show:t.canTicketing(n.row)},click:function(){return t.ticketing(n.row)},text:"出票"},{config:{loading:t.loadingBtn,style:{marginRight:"5px"},disabled:!t.canRefundAudit(n.row),show:t.canRefundAudit(n.row)},click:function(){return t.refundAuditView(n.row)},text:"退订审核"}])}}]},table:{query:{number:null,phone:null,start:null,end:null,status:null,itemStatus:null,refundStatus:null,self:!0},url:"/api/fx/order/list"},dateRangeOptions:{shortcuts:[{text:"今天",value:function(){var t=new Date;return[t,t]}},{text:"三天",value:function(){var t=new Date;return[d()().subtract(3,"day").toDate(),t]}},{text:"七天",value:function(){var t=new Date;return[d()().subtract(7,"day").toDate(),t]}}]},dateRange:[new Date,new Date],status:null,statusDic:{waitPay:"['1,2']",waitAudit:"['3', '1']",refundTicket:"['3', null, '3']",complete:"['4']",nonTicket:"['3', '3,4']",hasTicket:"['3', '6']",refundMoney:"['3', null, '6']",waitRefundTicket:"['3', null, '1']",cancel:"['5']"},refund:{show:!1,item:null,fee:0,money:0,loading:!1,cause:null,quantity:{col:[{title:"游玩日期",key:"day"},{title:"数量",key:"quantity"}],data:[]}},audit:{show:!1,loading:!1,item:null},refundAudit:{show:!1,loading:!1,item:null}}},computed:{haveData:function(){var t;return!!(null===(t=this.table.data)||void 0===t?void 0:t.length)},epId:function(){var t,e;return null===(t=this.$store.state.user.info)||void 0===t?void 0:null===(e=t.ep)||void 0===e?void 0:e.id},platformId:function(){var t,e;return null===(t=this.$store.state.user.info)||void 0===t?void 0:null===(e=t.platform)||void 0===e?void 0:e.id},epType:function(){var t,e;return null===(t=this.$store.state.user.info)||void 0===t?void 0:null===(e=t.epPlatform)||void 0===e?void 0:e.type},userType:function(){var t;return null===(t=this.$store.state.user.info)||void 0===t?void 0:t.type},refundProduct:function(){var t,e;return"".concat((null===(t=this.refund.item)||void 0===t?void 0:t.productName)||""," - ").concat((null===(e=this.refund.item)||void 0===e?void 0:e.productSubName)||"")}},watch:{status:function(t){if(t){var e=JSON.parse(t.replace(/'/g,'"')),n=Object(l["a"])(e,3),a=n[0],i=n[1],r=n[2];this.table.query.status=a,this.table.query.itemStatus=i,this.table.query.refundStatus=r}else this.table.query.status=null,this.table.query.itemStatus=null,this.table.query.refundStatus=null;this.doQuery()}},methods:{beforeQuery:function(){var t=Object(u["a"])(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:this.dateRange&&2===this.dateRange.length&&this.dateRange.every(function(t){return t instanceof Date})?(this.table.query.start=d()(this.dateRange[0]).format("YYYY-MM-DD 00:00:00"),this.table.query.end=d()(this.dateRange[1]).format("YYYY-MM-DD 23:59:59")):(this.table.query.start=null,this.table.query.end=null);case 1:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),processQueryData:function(){var t=Object(u["a"])(regeneratorRuntime.mark(function t(e,n){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",e.map(function(t){return Object(o["a"])({},t,{items:t.items.map(function(e){return Object(o["a"])({},e,{order:t})})})}));case 1:case"end":return t.stop()}},t,this)}));function e(e,n){return t.apply(this,arguments)}return e}(),goToPay:function(t){this.order=t,this.showPay=!0},goToPaying:function(t){this.order=t,this.showPaying=!0},closePaying:function(){this.showPaying=!1,this.showPay=!1},rePay:function(){this.showPaying=!1,this.showPay=!0},isSelfOrder:function(t){var e,n;return t=t||this.order,this.epId===(null===(e=t)||void 0===e?void 0:e.buyEpId)&&this.platformId===(null===(n=t)||void 0===n?void 0:n.buyPlatform)},canRefund:function(t){return 3===t.order.status&&[3,4,6].some(function(e){return e===t.status})&&this.isSelfOrder(t.order)&&t.quantity*t.days-t.usedQuantity-t.refundQuantity>0&&(!t.refundOrder||[7,2,4].some(function(e){return e===t.refundOrder.status}))},canAudit:function(t){return 3===t.order.status&&1===t.status&&t.supplierEpId===this.epId&&t.supplierPlatform===this.platformId},canTicketing:function(t){var e=this;return 3===t.order.status&&[3,4].some(function(e){return e===t.status})&&[2,3].some(function(t){return t===e.epType})&&!t.refundOrder},canRefundAudit:function(t){var e;return 3===t.order.status&&1===(null===(e=t.refundOrder)||void 0===e?void 0:e.status)&&t.supplierEpId===this.epId&&t.supplierPlatform===this.platformId},refundView:function(){var t=Object(u["a"])(regeneratorRuntime.mark(function t(e){var n,a;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.refund.loading=!0,this.$Spin.show(),t.next=4,this.post("/api/fx/order/refund/apply/calc-remainder",{number:e.number});case 4:n=t.sent,this.$Spin.hide(),n.success&&(this.refund.item=e,this.refund.show=!0,this.refund.fee=n.value.fee,this.refund.money=n.value.money,a=JSON.parse(n.value.data),this.refund.quantity.data=s()(a).map(function(t){return{day:t,quantity:a[t].reduce(function(t,e){return t+e.quantity},0)}}));case 7:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),refundApply:function(){var t=Object(u["a"])(regeneratorRuntime.mark(function t(){var e,n=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.post("/api/fx/order/refund/apply/remainder",{number:this.refund.item.number,cause:this.refund.cause});case 2:if(e=t.sent,e.success){t.next=7;break}return this.refund.loading=!1,this.$nextTick(function(){return n.refund.loading=!0}),t.abrupt("return");case 7:this.refund.show=!1,this.$Notice.success({title:"退订申请成功"}),setTimeout(function(){return n.doQuery()},500),this.refund.loading=!1;case 11:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),auditView:function(t){this.audit.loading=!0,this.audit.item=t,this.audit.show=!0},ticketing:function(){var t=Object(u["a"])(regeneratorRuntime.mark(function t(e){var n,a=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.loadingBtn=!0,t.next=3,this.get("/api/fx/order/ticketing/".concat(e.number));case 3:n=t.sent,n.success&&(this.$Notice.success({title:"发起出票成功"}),setTimeout(function(){return a.doQuery()},500)),this.loadingBtn=!1;case 6:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),doAudit:function(){var t=Object(u["a"])(regeneratorRuntime.mark(function t(e){var n,a=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.post("/api/fx/order/audit/".concat(this.audit.item.number,"?success=").concat(e));case 2:if(n=t.sent,n.success){t.next=7;break}return this.audit.loading=!1,this.$nextTick(function(){return a.audit.loading=!0}),t.abrupt("return");case 7:this.audit.show=!1,this.$Notice.success({title:"审核成功"}),setTimeout(function(){return a.doQuery()},500),this.audit.loading=!1;case 11:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),refundAuditView:function(t){this.refundAudit.loading=!0,this.refundAudit.item=t,this.refundAudit.show=!0},doRefundAudit:function(){var t=Object(u["a"])(regeneratorRuntime.mark(function t(e){var n,a=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.post("/api/fx/order/refund/audit/".concat(this.refundAudit.item.refundOrder.number,"?success=").concat(e));case 2:if(n=t.sent,n.success){t.next=7;break}return this.refundAudit.loading=!1,this.$nextTick(function(){return a.refundAudit.loading=!0}),t.abrupt("return");case 7:this.refundAudit.show=!1,this.$Notice.success({title:"退订审核成功"}),setTimeout(function(){return a.doQuery()},500),this.refundAudit.loading=!1;case 11:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}()}},g=w,b=(n("b8c2"),n("9216"),n("2877")),x=Object(b["a"])(g,a,i,!1,null,"0dd19b28",null);x.options.__file="list.vue";e["default"]=x.exports},"5b5c":function(t,e,n){"use strict";var a=n("a3a7"),i=n.n(a);i.a},9216:function(t,e,n){"use strict";var a=n("a33d"),i=n.n(a);i.a},a33d:function(t,e,n){},a3a7:function(t,e,n){},b2d1:function(t,e,n){t.exports=n.p+"img/wx-scan.41e6df9f.png"},b375:function(t,e,n){!function(e,n){t.exports=n()}("undefined"!=typeof self&&self,function(){return function(t){function e(a){if(n[a])return n[a].exports;var i=n[a]={i:a,l:!1,exports:{}};return t[a].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var n={};return e.m=t,e.c=n,e.d=function(t,n,a){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:a})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=1)}([function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=n(4),i=function(t){return t&&t.__esModule?t:{default:t}}(a);e.default={name:"VCountup",data:function(){return{counter:{},unitText:"",countId:"count"+parseInt(1e6*Math.random())}},props:{mainClass:String,countClass:String,mainStyle:{type:Object,default:function(){return{fontSize:"16px",fontWeight:500,color:"gray"}}},countStyle:Object,initCount:{type:Number,default:0},startVal:{type:Number,default:0},endVal:{type:Number,required:!0},simplify:{type:Boolean,default:!1},duration:{type:Number,default:2},delay:{type:Number,default:200},uneasing:{type:Boolean,default:!1},ungroup:{type:Boolean,default:!1},separator:{type:String,default:","},decimals:{type:Number,default:0},decimal:{type:String,default:"."},unit:{type:Array,default:function(){return[[3,"K+"],[6,"M+"],[9,"B+"]]}}},methods:{transformValue:function(t){var e=0,n="",a=this.unit.length;if(t<Math.pow(10,this.unit[0][0]))e=t;else for(var i=1;i<a;i++)t>=Math.pow(10,this.unit[i-1][0])&&t<Math.pow(10,this.unit[i][0])&&(e=parseInt(t/Math.pow(10,this.unit[i-1][0])),n=this.unit[i-1][1]);return t>Math.pow(10,this.unit[a-1][0])&&(e=parseInt(t/Math.pow(10,this.unit[a-1][0])),n=this.unit[a-1][1]),{val:e,unit:n}}},mounted:function(){var t=this;this.$nextTick(function(){setTimeout(function(){var e=0,n={};t.simplify?(n=t.transformValue(t.endVal),e=n.val,t.unitText=n.unit):e=t.endVal;var a={};t.counter=a=new i.default(t.countId,t.startVal,e,t.decimals,t.duration,{useEasing:!t.uneasing,useGrouping:!t.ungroup,separator:t.separator,decimal:t.decimal}),a.error||a.start()},t.delay)})},watch:{endVal:function(t){var e=0;if(this.simplify){var n=this.transformValue(this.endVal);e=n.val,this.unitText=n.unit}else e=this.endVal;this.counter&&this.counter.update&&this.counter.update(e)}}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=n(2),i=function(t){return t&&t.__esModule?t:{default:t}}(a);i.default.install=function(t){t.component(i.default.name,i.default)},e.default=i.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=n(0),i=n.n(a);for(var r in a)"default"!==r&&function(t){n.d(e,t,function(){return a[t]})}(r);var s=n(5),o=n.n(s),u=n(3),l=u(i.a,o.a,!1,null,null,null);l.options.__file="src\\countup.vue",e.default=l.exports},function(t,e){t.exports=function(t,e,n,a,i,r){var s,o=t=t||{},u=typeof t.default;"object"!==u&&"function"!==u||(s=t,o=t.default);var l,c="function"==typeof o?o.options:o;if(e&&(c.render=e.render,c.staticRenderFns=e.staticRenderFns,c._compiled=!0),n&&(c.functional=!0),i&&(c._scopeId=i),r?(l=function(t){t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,t||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),a&&a.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(r)},c._ssrRegister=l):a&&(l=a),l){var d=c.functional,f=d?c.render:c.beforeCreate;d?(c._injectStyles=l,c.render=function(t,e){return l.call(e),f(t,e)}):c.beforeCreate=f?[].concat(f,l):[l]}return{esModule:s,exports:o,options:c}}},function(t,e,n){var a,i;!function(r,s){a=s,void 0!==(i="function"==typeof a?a.call(e,n,e,t):a)&&(t.exports=i)}(0,function(t,e,n){return function(t,e,n,a,i,r){for(var s=0,o=["webkit","moz","ms","o"],u=0;u<o.length&&!window.requestAnimationFrame;++u)window.requestAnimationFrame=window[o[u]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[o[u]+"CancelAnimationFrame"]||window[o[u]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t,e){var n=(new Date).getTime(),a=Math.max(0,16-(n-s)),i=window.setTimeout(function(){t(n+a)},a);return s=n+a,i}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)});var l=this;for(var c in l.options={useEasing:!0,useGrouping:!0,separator:",",decimal:".",easingFn:null,formattingFn:null},r)r.hasOwnProperty(c)&&(l.options[c]=r[c]);""===l.options.separator&&(l.options.useGrouping=!1),l.options.prefix||(l.options.prefix=""),l.options.suffix||(l.options.suffix=""),l.d="string"==typeof t?document.getElementById(t):t,l.startVal=Number(e),l.endVal=Number(n),l.countDown=l.startVal>l.endVal,l.frameVal=l.startVal,l.decimals=Math.max(0,a||0),l.dec=Math.pow(10,l.decimals),l.duration=1e3*Number(i)||2e3,l.formatNumber=function(t){var e,n,a,i;if(t=t.toFixed(l.decimals),t+="",e=t.split("."),n=e[0],a=e.length>1?l.options.decimal+e[1]:"",i=/(\d+)(\d{3})/,l.options.useGrouping)for(;i.test(n);)n=n.replace(i,"$1"+l.options.separator+"$2");return l.options.prefix+n+a+l.options.suffix},l.easeOutExpo=function(t,e,n,a){return n*(1-Math.pow(2,-10*t/a))*1024/1023+e},l.easingFn=l.options.easingFn?l.options.easingFn:l.easeOutExpo,l.formattingFn=l.options.formattingFn?l.options.formattingFn:l.formatNumber,l.version=function(){return"1.7.1"},l.printValue=function(t){var e=l.formattingFn(t);"INPUT"===l.d.tagName?this.d.value=e:"text"===l.d.tagName||"tspan"===l.d.tagName?this.d.textContent=e:this.d.innerHTML=e},l.count=function(t){l.startTime||(l.startTime=t),l.timestamp=t;var e=t-l.startTime;l.remaining=l.duration-e,l.options.useEasing?l.countDown?l.frameVal=l.startVal-l.easingFn(e,0,l.startVal-l.endVal,l.duration):l.frameVal=l.easingFn(e,l.startVal,l.endVal-l.startVal,l.duration):l.countDown?l.frameVal=l.startVal-(l.startVal-l.endVal)*(e/l.duration):l.frameVal=l.startVal+(l.endVal-l.startVal)*(e/l.duration),l.countDown?l.frameVal=l.frameVal<l.endVal?l.endVal:l.frameVal:l.frameVal=l.frameVal>l.endVal?l.endVal:l.frameVal,l.frameVal=Math.round(l.frameVal*l.dec)/l.dec,l.printValue(l.frameVal),e<l.duration?l.rAF=requestAnimationFrame(l.count):l.callback&&l.callback()},l.start=function(t){return l.callback=t,l.rAF=requestAnimationFrame(l.count),!1},l.pauseResume=function(){l.paused?(l.paused=!1,delete l.startTime,l.duration=l.remaining,l.startVal=l.frameVal,requestAnimationFrame(l.count)):(l.paused=!0,cancelAnimationFrame(l.rAF))},l.reset=function(){l.paused=!1,delete l.startTime,l.startVal=e,cancelAnimationFrame(l.rAF),l.printValue(l.startVal)},l.update=function(t){cancelAnimationFrame(l.rAF),l.paused=!1,delete l.startTime,l.startVal=l.frameVal,l.endVal=Number(t),l.countDown=l.startVal>l.endVal,l.rAF=requestAnimationFrame(l.count)},l.printValue(l.startVal)}})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("p",{class:t.mainClass,style:t.mainStyle},[t._t("leftText"),t._v(" "),n("span",{class:t.countClass,style:t.countStyle},[n("span",{attrs:{id:t.countId}},[t._v(t._s(t.initCount))]),t._v(" "),t.simplify?n("span",[t._v(t._s(t.unitText))]):t._e()]),t._v(" "),t._t("rightText")],2)},i=[];a._withStripped=!0;var r={render:a,staticRenderFns:i};e.default=r}])})},b8c2:function(t,e,n){"use strict";var a=n("2009"),i=n.n(a);i.a}}]);
//# sourceMappingURL=chunk-aaa1a0b0.773ca6e3.js.map